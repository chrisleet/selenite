import matplotlib.pyplot as plt
import numpy as np

def constrain_spectra_wv(

def constrain_wv_grid(shard_dict, wv_grid_shard_dict):
  
  for order, shard in shard_dict.items():
    if order in wv_grid_shard_dict:

      spectrum = next(iter(wv_grid_shard_dict[order].spectra.values()))

      print("l_cutoff_wv", shard.l_cutoff_wv)
      print("r_cutoff_wv", shard.r_cutoff_wv)

      l_cutoff_px = np.argmax(spectrum.lin_x > shard.l_cutoff_wv)
      r_cutoff_px = np.argmax(spectrum.lin_x > shard.r_cutoff_wv)

      spectrum.lin_x = spectrum.lin_x[l_cutoff_px:r_cutoff_px]
      spectrum.log_y = spectrum.log_y[l_cutoff_px:r_cutoff_px]
      spectrum.continuum = spectrum.continuum[l_cutoff_px:r_cutoff_px]
      spectrum.uncertainty = spectrum.uncertainty[l_cutoff_px:r_cutoff_px]
      spectrum.snrs = spectrum.snrs[l_cutoff_px:r_cutoff_px]

      should_check_constraints = False
      if should_check_constraints:
        check_constraints(shard_dict, wv_grid_shard_dict, order)


def check_constraints(shard_dict, wv_grid_shard_dict, order):

  fig = plt.figure(facecolor="white")   
  for bstar_spectrum in shard_dict[order].spectra.values():
    plt.plot(bstar_spectrum.lin_x, bstar_spectrum.log_y, color="blue")

  sci_spectrum = next(iter(wv_grid_shard_dict[order].spectra.values()))
  plt.plot(sci_spectrum.lin_x, sci_spectrum.log_y, color="orange")

  plt.axvline(shard_dict[order].l_cutoff_wv)
  plt.axvline(shard_dict[order].r_cutoff_wv)

  plt.title("Constrained b stars order {}".format(order))
  plt.xlabel("Wavelength (A)")
  plt.ylabel("Signal intensity")

  plt.show()
  

